# 表形式仕様（決定表・状態遷移表）

## 1. 概要

表形式仕様は、複雑な条件と結果の関係を視覚的に整理し、仕様の完全性と一貫性を確保するための強力な形式手法である。決定表（Decision Table）、状態遷移表（State Transition Table）、Parnas表などの技法は、ソフトウェア工学において長年にわたって成功裏に使用されてきた[1][2]。

## 2. 決定表（Decision Table）

### 2.1 定義と目的

決定表は、与えられた条件に応じてどのアクション/出力を実行するかを指定する簡潔な視覚的表現である[1][2]。ソフトウェアテストと要求管理の両方で使用され、ビジネス分析において重要な役割を果たす[1]。

決定表は、1つの行が可能な各アクションに対応し、1つの行が各関連条件に対応し、1つの列が条件状態の各組み合わせに対応する2次元マトリクスである[2]。決定表は、複雑な条件とその結果としてのアクションを非常に簡潔かつ厳密に示すことができ、同時に人間の読者にとって理解可能である[2]。

### 2.2 構造とコンポーネント

**条件（Conditions）**：
決定表における「条件」は、どの決定またはアクションを取るべきかに影響を与える要因または状況である[1]。取るべき行動の方針は、既存の状況に依存する[1]。

**アクション（Actions）**：
各アクションは実行すべき手順または操作であり、エントリは、エントリが対応する条件代替の集合に対してアクションが実行されるかどうか（またはどの順序で）を指定する[2]。

**ルール（Rules）**：
ルールは、満たされたときに適切な行動方針を決定する条件の集合で構成される[1]。それらは、状況のさまざまな順列を評価することから導出され、決定表では行として描かれる[1]。

### 2.3 決定表の種類

限定エントリ決定表では、条件エントリは二値に制限される[2]。拡張エントリ決定表では、条件エントリは2つ以上の値を持つ[2]。

### 2.4 利点とアプリケーション

決定表テスト技法は、効果的なテストケースの体系的な選択を支援する[1]。この技法を使用すると、複雑なビジネスフローをテストシナリオとテストケースに簡単に変換できる[1]。

決定表は、コードよりも理解しやすく、レビューしやすいことが証明されており、複雑なシステムの仕様を生成するために広範囲かつ成功裏に使用されてきた[2]。

決定表テストは、仕様の問題と曖昧さを発見するという有益な副作用をもたらす可能性がある[1]。この技法は、すべてのテストケースの包括的なカバレッジを提供し、テストケースとテストシナリオの作成に関する再作業を大幅に削減できる[1]。

## 3. 状態遷移表（State Transition Table）

### 3.1 定義と目的

オートマトン理論と順序論理において、状態遷移表は、有限状態機械が現在の状態と他の入力に基づいてどの状態に移動するかを示す表である[3][4]。これは本質的に、入力に現在の状態と他の入力が含まれ、出力に次の状態と他の出力が含まれる真理値表である[3]。

### 3.2 仕様方法

状態遷移表は、有限状態機械を指定する多くの方法の1つである[3][4]。他の方法には状態図が含まれる[3]。状態遷移表は、有限状態機械の遷移関数の表形式表現として機能し、すべての可能な現在の状態、入力、および対応する次の状態を体系的にリストして、さまざまな条件下での機械の動作を定義する[4]。

### 3.3 形式手法への応用

非形式的なテキスト記述とは対照的に、状態遷移表は、すべての遷移の列挙を義務付けることで精度を強制し、それにより、エッジケースを見落としたり、意図しない動作を暗示したりする可能性のある自然言語仕様に固有の曖昧さを排除する[4]。

少ないスペースで多くのケースを表現するためにコンパクトな記号式を使用し、より単純なものから複雑な式を構築するために演算子を使用することは、形式手法における最も強力な概念の1つである[4]。

### 3.4 構造

一般的な配置の1つでは、次元の1つが現在の状態を示し、もう1つが入力を示す[3]。行/列の交点は、状態遷移に関連する次の状態と（オプションで）出力を示す[3]。

## 4. Parnas表

### 4.1 概要

Parnas表は、表形式の構造を使用して数学的式を整理し、行と列が式をケースに分離し、各表エントリが、あるケースの結果値またはあるケースを部分的に特定する条件を指定する[5]。表形式の式は、形式的なドキュメントが従来のドキュメントに取って代わることができるように、可読性を向上させるために使用される[5]。

### 4.2 完全性と不一致性

完全性は、Parnas表の重要な特性である[5]。表が適切と見なされるためには、2つの性質を満たす必要がある：不一致性（2つの条件が同時に真になることはない）と完全性（少なくとも1つの条件が真である）[5]。

### 4.3 完全性のチェック

要件表の一貫性と完全性の自動チェックは、仕様のエラーを明らかにでき、後の開発サイクルよりも早くそのようなエラーを修正することで、コストのかかる再作業と追加のテスト作業を回避できる[5]。定理証明器とSMTソルバーを活用することで表の完全性と一貫性をチェックするツールがあり、表が不一致かつ完全であることを証明できる[5]。

### 4.4 仕様の特性

表形式の式がサポートする仕様の特性には、（1）簡潔性、（2）精密性、（3）完全性への支援、（4）冗長性の回避、（5）すべての外部から見える動作の記述、（6）変更の容易性、（7）優れた参照ツールが含まれる[5]。

## 5. SCR（Software Cost Reduction）方式

### 5.1 概要

SCR（Software Cost Reduction）要求手法は、安全クリティカルなソフトウェアシステムの要求を指定するための、表に基づく形式手法である[6][7]。もともと1978年にNRL（Naval Research Laboratory）の研究者によって、米国海軍のA-7航空機の運用飛行プログラム（OFP）の要求を文書化するために策定されたSCRは、Grumann、Ontario Hydro、Bell Laboratories、Lockheedを含む多くの組織によって、ソフトウェア要求を指定するために実際に使用されてきた[6]。

### 5.2 主要な特徴

SCR手法は、要求を指定するために表形式の表記法を使用し、表形式の表記法の基礎となるのは状態機械セマンティクスである[6]。表に基づく仕様は、ソフトウェア実務者にとって比較的理解しやすく、作成しやすい[6]。

### 5.3 SCRツール

ツールには、仕様を構築するためのエディタ、形式的要求モデルとの一貫性について仕様をテストするための一貫性チェッカー、仕様を記号的に実行するためのシミュレータ、および仕様が選択されたアプリケーション特性を満たすことを確認するための検証器が含まれる[6]。

### 5.4 設計哲学

SCRツールは「実用的な」形式手法の一部である—定理証明スキル、時相論理や高階論理の知識、または形式手法の専門家との相談なしに、ソフトウェア開発者が適用できる堅実な数学的基盤を持つ方法である[7]。SCR手法は、要求を指定するための表形式の表記法と、いくつかのクラスのエラーを自動的に検出する「軽量」ツールのセットを提供する[7]。

## 6. 原因結果グラフ

### 6.1 概要

原因と結果のグラフは、原因が入力条件であり、効果がそれらの入力条件の結果である動的なテストケース作成技法である[8][9]。原因結果グラフは、結果とそれを引き起こすすべての要因との関係を示すブラックボックステスト技法に分類される[9]。

### 6.2 目的と利点

原因結果グラフは、一連の要求から始まり、最大のテストカバレッジのための最小限の可能なテストケースを決定する技法であり、テスト実行時間とコストを削減する[8]。原因結果グラフ手法の主な利点は、不完全または不明確な要求が存在する場所を検出するのに役立つことである[8]。

### 6.3 主要な表記法と関数

論理的であるため、AND、OR、NOTなどのブール演算子を使用することは明白である[9]。一般的な表記法には次のものが含まれる[9]：
- 恒等関数：cが1の場合、eは1である。そうでなければeは0である
- NOT関数：cが1の場合、eは0である。そうでなければeは1である

### 6.4 決定表への変換

原因結果グラフ内の状態条件をリンクすることによって、原因結果グラフを限定エントリ決定表に変換する[9]。決定表では、各列がテストケースに変換される[9]。決定表の各列は、テストケースに変換される[9]。

### 6.5 方法論のステップ

原因結果グラフに基づくテスト技法は、以下のステップで構成される[9]：テストすべきユニットを分解する、原因を特定する、効果を特定する、原因と効果の間の関係のグラフを確立する、原因と効果の間の制約を追加してグラフを完成させる、グラフを決定表に変換する、表を簡略化した後に行ごとにテストを生成する[9]。

## 7. 表形式仕様の完全性チェック

### 7.1 利点

表形式の式は、可読性、完全性、不一致性の利点があり、通常、数学的式と再帰的定義を使用して定義され、数学的関数と関係を表現するために使用される[10]。表形式の式は、ソフトウェア要求を形式的に指定するための最も重要な表ベースの技法の1つであり、30年以上にわたってソフトウェア開発で成功裏に使用されてきた[10]。

### 7.2 完全性チェック

要件表の一貫性と完全性の自動チェックは、仕様のエラーを明らかにでき、後の開発サイクルよりも早くそのようなエラーを修正することで、コストのかかる再作業と追加のテスト作業を回避できる[10]。表形式の要求は、「if-then」パラダイムを使用してソフトウェア要求の仕様化を支援し、多くのツールによってサポートされている[10]。

バージョンR2022a以降、Simulink®は、要求が状態を持たない場合、つまり時間にわたる動作を制約しない場合、要件表の完全性と一貫性のチェックをサポートしている[10]。

### 7.3 欠点

表形式表現に関連する制限には、個々の項目への焦点の欠如、記述の範囲または潜在性がないこと、専門知識が必要であることが含まれる[10]。

## 8. 表形式仕様とテスト設計の関係

### 8.1 決定表テスト

決定表テストは、入力条件の組み合わせと期待されるシステムアクションを構造化された表形式で整理するブラックボックステスト技法である[11]。表の各列は一意のルール—特定の入力の組み合わせとそれに対応する出力—を表し、体系的で包括的なテストカバレッジを保証する[11]。

### 8.2 主要コンポーネント

条件はシステムの動作に影響を与える入力変数であり、アクションは与えられた条件に対するシステムの応答または出力であり、ルールは条件とアクションの特定の組み合わせであり、それぞれが個別のテストケースを表す[11]。この形式により、テスターはすべての可能なシナリオを明確に視覚化し、それらを実行可能なテストケースに直接変換できる[11]。

### 8.3 テストケース生成プロセス

テストベースは、決定表、疑似コード、プロセス記述、または条件が発生する他の機能的記述で構成され、条件と結果が決定表に入れられる[11]。複数条件カバレッジでは、各条件に対して個別に複数のテストケースを生成し、結果のすべての可能な組み合わせをテストできるようにする[11]。

### 8.4 利点

決定表で条件をアクションにマッピングすることにより、テスターは包括的なテストカバレッジを保証し、潜在的なギャップを特定し、テストプロセスを合理化できる[11]。決定表は、可能性を1か所に整理して、テスターに徹底的なテストケースを構築するための信頼できる構造を提供し、表形式のルールベースの構造により、自動化されたテストスクリプトに簡単に変換でき、複数の条件にわたる検証を加速する[11]。

### 8.5 仕様のための表形式式

表形式式は、数学的に正確だが読みやすいソフトウェア仕様を文書化するための表記法として提案されており、その役割の1つは、パーティション戦略、決定表ベースのテスト、フォールトベースのテストなどのテスト戦略の適用を通じてテスターを導くことである[12]。

## 9. 一貫性と完全性の検証

### 9.1 形式的分析

一貫性チェックと呼ばれる形式的分析技法は、SCR（Software Cost Reduction）表形式表記法で表現された要求仕様において、型エラー、非決定性、欠落ケース、循環定義などのエラーを自動的に検出できる[13]。

### 9.2 完全性と一貫性の分析

形式的な状態ベースの要求仕様を完全性と一貫性について自動的に分析する方法が開発されている[13]。完全性（欠落ルールの検出）の観点だけでなく、一貫性と非冗長性（重複ルールの検出）の観点からも決定表を分析する必要性が広く認識されている[13]。

### 9.3 形式手法の適用

要件表を使用して、要件のセットの一貫性と完全性を形式的に証明できる[13]。制御された自然言語または形式仕様言語を使用すると、曖昧さが取り除かれ、仕様自体の検証（たとえば、一貫性と完全性のチェック）が可能になる[13]。

### 9.4 実用的なツールとアプローチ

決定表が提供する形式的構造により、複数の類似したルールの作成、理解、変更が容易になり、ソフトウェアがルールの完全性と一貫性をチェックできるようになる[13]。決定表サポートのプロセッサは、知識ベースの完全性と一貫性をチェックできる[13]。

### 9.5 DMN（Decision Model and Notation）

DMN決定表の形式的セマンティクスが提案されており、分析タスクの形式的定義があり、幾何学的解釈に基づいて決定表を分析およびリファクタリングする一般的なアプローチが提案されている[13]。

## 10. 表形式仕様の利点と限界

### 10.1 利点

**網羅性の視覚化**：
表形式は、すべての可能な条件の組み合わせとその結果を視覚的に明確にし、網羅性を確保しやすい。

**可読性と理解性**：
数学的に厳密でありながら、表形式は技術者以外のステークホルダーにも理解しやすい形式である。

**完全性と一貫性のチェック**：
自動化ツールを使用して、仕様の完全性（すべてのケースがカバーされているか）と一貫性（矛盾がないか）を検証できる。

**テストケースの直接生成**：
表形式仕様から直接テストケースを生成でき、仕様とテストの間のトレーサビリティが向上する。

**形式的検証との統合**：
定理証明器やSMTソルバーと統合して、仕様の性質を形式的に証明できる。

### 10.2 限界

**複雑性の限界**：
非常に多くの条件や状態を持つシステムでは、表が巨大になり管理が困難になる。

**動的な振る舞いの表現**：
時間的な制約や並行性など、動的な振る舞いの表現には限界がある。

**専門知識の必要性**：
効果的に使用するには、表形式仕様の作成と解釈に関する専門知識が必要である。

**記述の範囲**：
個々の項目の詳細な記述や背景情報を提供する範囲が限られている。

## 11. まとめ

### 11.1 表形式仕様の重要性

表形式仕様は、形式手法とソフトウェア工学の実践を橋渡しする重要な技法である。決定表、状態遷移表、Parnas表、SCR方式などは、それぞれ特定の種類の仕様に適しており、長年の実用実績がある。

### 11.2 主要な技法の特徴

- **決定表**：複雑な条件とアクションの関係を明確化
- **状態遷移表**：有限状態機械の振る舞いを厳密に定義
- **Parnas表**：数学的に正確で可読性の高い仕様
- **SCR方式**：実用的な形式手法として多くの産業で採用

### 11.3 完全性と一貫性の保証

表形式仕様の最大の利点の1つは、自動化ツールによる完全性と一貫性のチェックが可能なことである。定理証明器やSMTソルバーとの統合により、仕様の厳密な検証が実現される。

### 11.4 テスト設計との関係

表形式仕様は、テスト設計と密接に関連している。原因結果グラフから決定表へ、決定表からテストケースへという流れは、要求からテストへのトレーサビリティを保証する。

### 11.5 実践的価値

表形式仕様は、以下の理由で実践的価値が高い：

1. **可読性**：技術者以外のステークホルダーとのコミュニケーションが容易
2. **完全性**：すべてのケースを網羅的に扱うことを強制
3. **検証可能性**：自動化ツールによる検証が可能
4. **保守性**：変更や拡張が比較的容易

### 11.6 今後の方向性

- AI/機械学習を用いた表形式仕様の自動生成
- より大規模で複雑なシステムへの適用手法の開発
- 他の形式手法（モデル検査、定理証明）との統合の深化
- リアルタイムシステムや並行システムへの適用拡大

表形式仕様は、形式的でありながら実用的という理想的なバランスを実現した技法であり、安全クリティカルシステムから業務システムまで、幅広い領域で今後も重要な役割を果たし続けるだろう。

## 参考文献

1. [Decision Table Based Testing in Software Testing - GeeksforGeeks](https://www.geeksforgeeks.org/software-engineering/decision-table-based-testing-in-software-testing/)
2. [Decision table - Wikipedia](https://en.wikipedia.org/wiki/Decision_table)
3. [State-transition table - Wikipedia](https://en.wikipedia.org/wiki/State-transition_table)
4. [State Transition Table - ScienceDirect Topics](https://www.sciencedirect.com/topics/computer-science/state-transition-table)
5. [Parnas Tables: A Practical Formalism - Joanne M. Atlee](https://cs.uwaterloo.ca/~jmatlee/Talks/Parnas01.pdf)
6. [SCR: a toolset for specifying and analyzing requirements](https://www.researchgate.net/publication/3652316_SCR_a_toolset_for_specifying_and_analyzing_requirements)
7. [SCR: A PRACTICAL METHOD FOR REQUIREMENTS SPECIFICATION](https://apps.dtic.mil/sti/tr/pdf/ADA465445.pdf)
8. [Cause Effect Graph Technique in Software Testing](https://www.softwaretestinghelp.com/cause-and-effect-graph-test-case-writing-technique/)
9. [Cause Effect Graphing in Software Engineering - GeeksforGeeks](https://www.geeksforgeeks.org/software-engineering/cause-effect-graphing-in-software-engineering/)
10. [Tabular Expressions in Software Engineering](https://www.researchgate.net/publication/228939082_Tabular_Expressions_in_Software_Engineering)
11. [Decision Table Testing: A Complete Guide](https://katalon.com/resources-center/blog/decision-table-testing-guide)
12. [A Comparison of Tabular Expression-Based Testing Strategies](https://www.researchgate.net/publication/224251592_A_Comparison_of_Tabular_Expression-Based_Testing_Strategies)
13. [Automated consistency checking of requirements specifications](https://dl.acm.org/doi/10.1145/234426.234431)
